@page "/server"
@inject HttpClient Http

<PageTitle>Server Status</PageTitle>

<h1>7 Days to Die Server</h1>
<p>Status: @statusText</p>

@if (players.Count > 0)
{
    <table class="table">
        <thead>
            <tr>
                <th>Players Online (@players.Count)</th>
            </tr>
        </thead>
        <tbody>
        @foreach (var p in players)
        {
            <tr><td>@p</td></tr>
        }
        </tbody>
    </table>
}

@if (statusText == "Offline")
{
    <button @onclick="StartServer">Start Server</button>
}

@code {
    private string statusText = "Loading...";
    private List<string> players = new();

    protected override async Task OnInitializedAsync()
    {
        statusText = await GetServerStatus();
        players = await GetPlayers();
    }

    private async Task<string> GetServerStatus()
    {
        await Task.Delay(100);
        return "Online";
    }

    private async Task<List<string>> GetPlayers()
    {
        await Task.Delay(100);
        return new List<string> { "Avarice", "Madmanmatt", "J3ster" };
    }

    private async Task StartServer()
    {
        await Task.Delay(100);
        statusText = "Online";
    }
}
